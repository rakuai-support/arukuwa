# 実装計画・ロードマップ (Implementation Plan & Roadmap)

## 1. プロジェクト概要

**プロジェクト名**: Arukuwa - 引きこもり当事者向けライフプラン可視化Webアプリ

**開発期間**: 3〜4ヶ月（MVP: 2ヶ月）

**目標**:
- 引きこもり当事者が将来の家計を可視化できるツールを提供
- 心理的負担の少ないUI/UXの実現
- プライバシーを最大限に保護
- Gemini APIを活用した高度な分析とアドバイス

## 2. 開発フェーズ

### Phase 1: 基盤構築 (2週間)

**目標**: 開発環境とプロジェクト基盤の構築

#### Week 1-2: 環境構築・基本設計

**バックエンド**:
- [x] ドキュメント作成完了
- [ ] プロジェクト構造の構築
- [ ] Flask アプリケーションの初期化
- [ ] データベースモデルの実装
- [ ] Alembicマイグレーションの設定
- [ ] 基本的なAPIエンドポイント (`/health`, `/session`)
- [ ] Gemini API統合の基礎実装
- [ ] ユニットテストの基盤構築

**フロントエンド**:
- [ ] プロジェクト構造の構築
- [ ] Vite + React + TypeScript環境の構築
- [ ] Tailwind CSS設定
- [ ] ルーティング設定 (React Router)
- [ ] Context API設定 (Session, Question管理)
- [ ] 共通コンポーネントの実装 (Button, Input, Card等)
- [ ] レイアウトコンポーネントの実装

**成果物**:
- ✅ 技術仕様書
- ✅ API設計書
- ✅ データベース設計書
- ✅ フロントエンド設計書
- ✅ セキュリティ設計書
- ✅ セットアップガイド
- [ ] 動作する基本的なAPI
- [ ] 基本的なフロントエンド構造

---

### Phase 2: コア機能実装 (4週間)

**目標**: 主要機能の実装とGemini API統合

#### Week 3-4: 質問フローと計算ロジック

**バックエンド**:
- [ ] ライフプラン計算ロジックの実装
  - [ ] 基本的なキャッシュフロー計算
  - [ ] 年次データの生成
  - [ ] 資金枯渇時期の算出
- [ ] `/api/v1/calculate` エンドポイントの実装
  - [ ] 入力バリデーション
  - [ ] 計算処理
  - [ ] 結果のJSON生成
- [ ] データベース連携
  - [ ] 計算結果の保存
  - [ ] 年次データの保存
- [ ] ユニットテスト (カバレッジ80%以上)

**フロントエンド**:
- [ ] ホーム画面の実装
  - [ ] ヒーローセクション
  - [ ] 機能紹介
  - [ ] スタートボタン
- [ ] 質問ステップ画面の実装
  - [ ] プログレスバー
  - [ ] 質問入力コンポーネント
  - [ ] バリデーション
  - [ ] ステップ遷移ロジック
- [ ] 状態管理 (QuestionContext)
- [ ] APIクライアントの実装

**成果物**:
- [ ] 質問4つに回答できる
- [ ] 基本的なライフプラン計算が動作
- [ ] 計算結果がデータベースに保存される

#### Week 5-6: Gemini API統合と結果表示

**バックエンド**:
- [ ] Gemini APIクライアントの実装
  - [ ] プロンプト生成ロジック
  - [ ] API呼び出し処理
  - [ ] レスポンスパース
  - [ ] エラーハンドリング
  - [ ] リトライロジック
- [ ] AI分析機能の実装
  - [ ] ライフプラン分析
  - [ ] リスク要因の抽出
  - [ ] 改善提案の生成
  - [ ] アドバイスメッセージの生成
- [ ] キャッシング機能 (同じ入力の場合)
- [ ] レート制限対応
- [ ] AIレスポンスのバリデーション

**フロントエンド**:
- [ ] 計算中画面の実装
  - [ ] ローディングアニメーション
  - [ ] 進捗メッセージ
- [ ] 結果表示画面の実装
  - [ ] サマリーカード
  - [ ] 統計情報の表示
  - [ ] AIアドバイスカード
  - [ ] 改善提案リスト
- [ ] グラフコンポーネントの実装
  - [ ] Chart.js統合
  - [ ] 残高推移グラフ
  - [ ] 資金枯渇ポイントの強調表示
  - [ ] レスポンシブ対応

**成果物**:
- [ ] Gemini APIによる分析機能が動作
- [ ] グラフで結果が可視化される
- [ ] AIのアドバイスが表示される

---

### Phase 3: 目標管理機能 (2週間)

**目標**: 行動目標設定機能の実装

#### Week 7-8: 目標管理

**バックエンド**:
- [ ] 目標管理APIの実装
  - [ ] `POST /api/v1/goals` - 目標作成
  - [ ] `GET /api/v1/goals` - 目標一覧取得
  - [ ] `PATCH /api/v1/goals/{id}` - 目標更新
  - [ ] `DELETE /api/v1/goals/{id}` - 目標削除
- [ ] AI目標提案機能
  - [ ] `POST /api/v1/ai/suggest-goals`
  - [ ] ユーザー状況に応じた目標生成
- [ ] データベース連携
- [ ] バリデーション

**フロントエンド**:
- [ ] 目標設定画面の実装
  - [ ] AI提案の表示
  - [ ] 目標選択UI
  - [ ] カスタム目標入力
  - [ ] 保存機能
- [ ] 目標一覧画面の実装
  - [ ] 目標リスト表示
  - [ ] 進捗状況の表示
  - [ ] 編集・削除機能
- [ ] 状態管理 (GoalContext)

**成果物**:
- [ ] AI提案に基づいて目標を設定できる
- [ ] カスタム目標を作成できる
- [ ] 目標一覧を表示・管理できる

---

### Phase 4: セキュリティ・最適化 (2週間)

**目標**: セキュリティ強化とパフォーマンス最適化

#### Week 9-10: セキュリティとパフォーマンス

**バックエンド**:
- [ ] セキュリティ強化
  - [ ] CSRF対策の実装
  - [ ] レート制限の設定
  - [ ] 入力サニタイゼーション
  - [ ] SQLインジェクション対策の確認
  - [ ] XSS対策の確認
- [ ] セキュリティヘッダーの設定
  - [ ] CSP設定
  - [ ] HSTS有効化
  - [ ] X-Frame-Options設定
- [ ] ログ機能の実装
  - [ ] アクセスログ
  - [ ] エラーログ
  - [ ] セキュリティイベントログ
- [ ] パフォーマンス最適化
  - [ ] データベースインデックス
  - [ ] クエリ最適化
  - [ ] キャッシング戦略

**フロントエンド**:
- [ ] セキュリティ対策
  - [ ] 入力バリデーション強化
  - [ ] XSS対策の確認
  - [ ] データの暗号化 (LocalStorage)
- [ ] パフォーマンス最適化
  - [ ] コード分割 (React.lazy)
  - [ ] 画像最適化
  - [ ] バンドルサイズの削減
  - [ ] メモ化の実装
- [ ] アクセシビリティ対応
  - [ ] ARIA属性の追加
  - [ ] キーボード操作対応
  - [ ] スクリーンリーダー対応
  - [ ] コントラスト比の確認

**共通**:
- [ ] エラーハンドリングの改善
- [ ] ユーザーフィードバックの改善
- [ ] ローディング状態の改善

**成果物**:
- [ ] セキュリティ対策が実装されている
- [ ] パフォーマンスが最適化されている
- [ ] アクセシビリティ要件を満たす

---

### Phase 5: テストとデバッグ (2週間)

**目標**: 包括的なテストとバグ修正

#### Week 11-12: テストとQA

**バックエンド**:
- [ ] ユニットテストの拡充
  - [ ] カバレッジ90%以上
  - [ ] エッジケースのテスト
- [ ] 統合テスト
  - [ ] APIエンドポイントテスト
  - [ ] データベーステスト
  - [ ] Gemini API統合テスト
- [ ] 負荷テスト
  - [ ] 同時接続テスト
  - [ ] レート制限のテスト

**フロントエンド**:
- [ ] ユニットテストの拡充
  - [ ] コンポーネントテスト
  - [ ] フックテスト
  - [ ] ユーティリティ関数テスト
- [ ] E2Eテスト
  - [ ] Playwright/Cypress導入
  - [ ] 主要ユーザーフローのテスト
  - [ ] エラーケースのテスト
- [ ] ブラウザ互換性テスト
  - [ ] Chrome, Firefox, Safari
  - [ ] モバイルブラウザ

**QA**:
- [ ] 機能テスト
- [ ] UI/UXテスト
- [ ] セキュリティテスト
- [ ] パフォーマンステスト
- [ ] バグ修正

**成果物**:
- [ ] テストカバレッジ90%以上
- [ ] E2Eテストが通過
- [ ] 既知のバグが修正されている

---

### Phase 6: デプロイと公開準備 (2週間)

**目標**: 本番環境へのデプロイとローンチ

#### Week 13-14: デプロイと公開

**インフラ**:
- [ ] 本番環境の構築
  - [ ] サーバーのセットアップ (AWS/GCP/Heroku)
  - [ ] データベースのセットアップ (PostgreSQL)
  - [ ] Redisのセットアップ
  - [ ] HTTPS設定 (Let's Encrypt)
  - [ ] ドメイン設定
- [ ] CI/CDパイプラインの構築
  - [ ] GitHub Actions設定
  - [ ] 自動テスト
  - [ ] 自動デプロイ
- [ ] 監視・ログの設定
  - [ ] アプリケーション監視
  - [ ] エラートラッキング (Sentry)
  - [ ] アクセス解析

**ドキュメント**:
- [ ] ユーザー向けドキュメント
  - [ ] 使い方ガイド
  - [ ] FAQ
  - [ ] プライバシーポリシー
  - [ ] 利用規約
- [ ] 運用ドキュメント
  - [ ] デプロイ手順
  - [ ] バックアップ手順
  - [ ] トラブルシューティング

**最終チェック**:
- [ ] セキュリティチェックリストの確認
- [ ] パフォーマンステスト
- [ ] 本番データでの動作確認
- [ ] バックアップの確認

**成果物**:
- [ ] 本番環境が稼働
- [ ] ドキュメントが完備
- [ ] サービス公開準備完了

---

## 3. MVP (Minimum Viable Product) 定義

**MVP完成時期**: 2ヶ月後 (Phase 1-3完了時点)

**MVPに含まれる機能**:

1. **質問入力フロー**
   - 4つの質問（年齢、生活費、資産、支援受給）
   - ステップ形式のUI
   - 入力バリデーション

2. **ライフプラン計算**
   - 基本的なキャッシュフロー計算
   - Gemini APIによる分析
   - 資金枯渇時期の算出

3. **結果表示**
   - グラフによる可視化
   - サマリー情報
   - AIのアドバイス

4. **目標設定** (簡易版)
   - AI提案の表示
   - 目標の保存

5. **基本的なセキュリティ**
   - HTTPS
   - 入力バリデーション
   - セッション管理

**MVPに含まれない機能**:
- ユーザー登録・ログイン
- 複雑な家計管理機能
- データエクスポート
- SNSシェア機能
- PWA対応

---

## 4. タスク管理

### 4.1 開発手法

**アジャイル開発**:
- スプリント: 2週間
- デイリースタンドアップ: 15分
- スプリントレビュー: 1時間
- レトロスペクティブ: 30分

### 4.2 タスク管理ツール

- GitHub Issues / Projects
- タスクのラベリング:
  - `feature`: 新機能
  - `bug`: バグ修正
  - `enhancement`: 機能改善
  - `security`: セキュリティ関連
  - `documentation`: ドキュメント
  - `priority-high`: 高優先度
  - `priority-medium`: 中優先度
  - `priority-low`: 低優先度

### 4.3 ブランチ戦略

```
main (本番)
├── develop (開発)
│   ├── feature/user-questions
│   ├── feature/calculation-logic
│   ├── feature/gemini-integration
│   ├── feature/result-visualization
│   └── feature/goal-management
```

**ブランチ命名規則**:
- `feature/機能名` - 新機能開発
- `bugfix/バグ名` - バグ修正
- `hotfix/緊急修正名` - 緊急修正
- `refactor/リファクタリング内容` - リファクタリング

---

## 5. リリース計画

### 5.1 リリーススケジュール

| バージョン | 時期 | 内容 |
|-----------|------|------|
| v0.1.0 (Alpha) | 1ヶ月後 | 基本機能の実装完了 |
| v0.5.0 (Beta) | 2ヶ月後 | MVP完成、クローズドベータ開始 |
| v1.0.0 (GA) | 3ヶ月後 | 一般公開 |
| v1.1.0 | 4ヶ月後 | フィードバック反映、機能追加 |

### 5.2 ベータテスト

**クローズドベータ**:
- 期間: 2週間
- 対象: 10〜20名
- 目的: バグ発見、UXフィードバック
- 募集方法: SNS、支援団体経由

**フィードバック収集**:
- アンケート
- ユーザーインタビュー
- 使用ログ分析

---

## 6. 今後の拡張機能（Phase 7以降）

### v1.1.0 以降の機能追加予定

**優先度: 高**
1. **ユーザー登録・ログイン機能**
   - メールアドレス認証
   - パスワードレスログイン
   - データの永続化

2. **データエクスポート機能**
   - PDF出力
   - CSV出力

3. **複数シナリオ比較**
   - ベストケース/ワーストケース
   - What-if分析

**優先度: 中**
4. **通知機能**
   - 目標リマインダー
   - メール通知

5. **家計簿連携**
   - マネーフォワード連携
   - 自動データ取込

6. **SNSシェア機能**
   - 匿名での結果シェア

**優先度: 低**
7. **PWA対応**
   - オフライン機能
   - インストール可能

8. **多言語対応**
   - 英語対応

9. **チャットボットUI**
   - より会話的なインターフェース

---

## 7. リスク管理

### 7.1 技術的リスク

| リスク | 影響度 | 確率 | 対策 |
|--------|--------|------|------|
| Gemini API制限超過 | 高 | 中 | キャッシング、レート制限、代替AI検討 |
| セキュリティ脆弱性 | 高 | 中 | セキュリティレビュー、ペネトレーションテスト |
| パフォーマンス問題 | 中 | 低 | 負荷テスト、最適化 |
| ブラウザ互換性 | 低 | 中 | クロスブラウザテスト |

### 7.2 プロジェクト管理リスク

| リスク | 影響度 | 確率 | 対策 |
|--------|--------|------|------|
| スコープクリープ | 高 | 高 | MVP明確化、優先度管理 |
| スケジュール遅延 | 中 | 中 | バッファ確保、定期レビュー |
| リソース不足 | 中 | 低 | タスク優先度付け |

---

## 8. 成功指標 (KPI)

### 8.1 技術指標

- [ ] テストカバレッジ: 90%以上
- [ ] ページロード時間: 2秒以内
- [ ] APIレスポンス時間: 3秒以内
- [ ] エラー率: 1%以下
- [ ] セキュリティスキャン: 脆弱性ゼロ

### 8.2 ユーザー指標（公開後）

- [ ] MAU (月間アクティブユーザー): 1,000人
- [ ] 計算完了率: 80%以上
- [ ] 目標設定率: 50%以上
- [ ] ユーザー満足度: 4.0/5.0以上

---

## 9. チーム構成

**推奨チーム構成**:
- プロダクトオーナー: 1名
- バックエンドエンジニア: 1〜2名
- フロントエンドエンジニア: 1〜2名
- デザイナー: 1名（パートタイム可）
- QAエンジニア: 1名（パートタイム可）

**最小構成** (MVP):
- フルスタックエンジニア: 1〜2名

---

## 10. まとめ

本実装計画に従って開発を進めることで、3〜4ヶ月でArukuwaをリリースできる見込みです。

**重要なマイルストーン**:
- ✅ **Week 2**: ドキュメント完成、環境構築完了
- [ ] **Week 6**: MVP機能実装完了
- [ ] **Week 10**: セキュリティ・最適化完了
- [ ] **Week 12**: テスト完了
- [ ] **Week 14**: 本番リリース

次のステップは、**Phase 1: 基盤構築**の開始です。開発環境のセットアップから始めましょう。

---

## 付録: 参考資料

- [技術仕様書](docs/technical/TECHNICAL_SPEC.md)
- [API設計書](docs/api/API_DESIGN.md)
- [データベース設計書](docs/database/DATABASE_DESIGN.md)
- [フロントエンド設計書](docs/frontend/FRONTEND_DESIGN.md)
- [セキュリティ設計書](docs/security/SECURITY_DESIGN.md)
- [セットアップガイド](docs/setup/SETUP_GUIDE.md)
